{% extends 'layout.html' %}
{% load static %}

{% block title %}Bienvenido a Imago{% endblock %}

{% block container_class %}{% endblock %}

{% block content %}

{% if hero_config %}
<section class="hero-section" style="background-image: url('{{ hero_config.imagen_fondo.url }}');">
    <div class="hero-overlay"></div>
    <div class="hero-content">
        <h1 class="js-scroll-fade-in">{{ hero_config.titulo }}</h1>
        {% if hero_config.subtitulo %}
            <p class="js-scroll-fade-in">{{ hero_config.subtitulo }}</p>
        {% endif %}
        {% if hero_config.texto_boton and hero_config.enlace_boton %}
            <a href="{{ hero_config.enlace_boton }}" class="btn-dinamico btn-primary js-scroll-fade-in">{{ hero_config.texto_boton }}</a>
        {% endif %}
    </div>
</section>
{% else %}
    <!-- Mensaje para administradores si el Hero no está configurado -->
    <div style="padding: 4rem 2rem; text-align:center; background-color: #f86874ff; color: var(--secondary-text-color);">
        <h2>Sección Hero no configurada.</h2>
        <p>Por favor, ve al panel de administración y crea la "Configuración de la Sección Hero".</p>
    </div>
{% endif %}

<main class="landing-content">

    <!-- ====================================================== -->
    <!--     SISTEMA ÚNICO DE BLOQUES DE CONTENIDO DINÁMICOS    -->
    <!-- ====================================================== -->
    {% for block in bloques_home %}
        {# Bloques de contenido simple #}
        {% if block.tipo_bloque == 'reflexion' %}
            {% include 'home_blocks/_block_reflexion.html' with block=block %}
        {% elif block.tipo_bloque == 'texto_fondo' %}
            {% include 'home_blocks/_block_texto_fondo.html' with block=block %}
        {% elif block.tipo_bloque == 'parallax' %}
            {% include 'home_blocks/_block_parallax.html' with block=block %}

        {# Bloques que renderizan secciones enteras #}
        {% elif block.tipo_bloque == 'seccion_valoradas' %}
            {% include 'pages/home/_seccion_mejor_valoradas.html' %}
        {% elif block.tipo_bloque == 'seccion_recientes' %}
            {% include 'pages/home/_seccion_recientes.html' %}
        {% elif block.tipo_bloque == 'seccion_foros' %}
            {% include 'pages/home/_seccion_foros_destacados.html' %}
        {% endif %}
    {% endfor %}

</main>
{% endblock %}

{% block extra_js %}
<!-- ======================= SCRIPT PARA ANIMACIONES DE SCROLL ======================= -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const scrollElements = document.querySelectorAll('.js-scroll-fade-in');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            // Cuando el elemento es visible
            if (entry.isIntersecting) {
                entry.target.classList.add('scrolled');
                // Dejamos de observar el elemento una vez animado para mejorar el rendimiento
                observer.unobserve(entry.target);
            }
        });
    }, {
        threshold: 0.1 // Activa la animación cuando el 10% del elemento es visible
    });

    scrollElements.forEach(el => {
        observer.observe(el);
    });
});
</script>
{% endblock %}
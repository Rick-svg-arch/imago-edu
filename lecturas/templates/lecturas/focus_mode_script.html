<!-- lecturas/focus_mode_script.html -->
<style>
    /* === MODO CONCENTRACI√ìN - VERSI√ìN ULTRA SIMPLIFICADA === */
    
    /* Bot√≥n de salir - oculto por defecto */
    #btn-exit-focus {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 999999;
        padding: 0.75rem 1.5rem;
        background-color: #0c9196;
        color: white;
        border: 2px solid white;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        display: none;
    }

    /* CLASE PARA MODO CONCENTRACI√ìN */
    .focus-mode-active {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 80px 40px 40px 40px !important;
        overflow-y: auto !important;
        background-color: #fdfdfd !important;
        z-index: 999998 !important;
        border: none !important;
        border-radius: 0 !important;
        box-shadow: none !important;
    }

    /* Modo oscuro */
    body.dark-mode .focus-mode-active {
        background-color: #121212 !important;
    }

    /* Cuando est√° activo el modo */
    body.focus-mode {
        overflow: hidden !important;
    }

    body.focus-mode #btn-exit-focus {
        display: block !important;
    }

    body.focus-mode #btn-enter-focus {
        display: none !important;
    }

    body.focus-mode .main-header,
    body.focus-mode .acciones-documento,
    body.focus-mode #comentarios-container,
    body.focus-mode hr {
        display: none !important;
    }

    /* Centrar contenido */
    .focus-mode-active > * {
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
    }

    /* Mejorar legibilidad */
    .focus-mode-active {
        font-size: 1.15em;
        line-height: 1.9;
    }

    .focus-mode-active .page-header {
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid #eaeaea;
    }

    body.dark-mode .focus-mode-active .page-header {
        border-bottom-color: #38383a;
    }

    .focus-mode-active .contenido-post {
        margin-top: 2rem;
    }

    /* Scrollbar */
    .focus-mode-active::-webkit-scrollbar {
        width: 12px;
    }

    .focus-mode-active::-webkit-scrollbar-track {
        background: #eaeaea;
    }

    body.dark-mode .focus-mode-active::-webkit-scrollbar-track {
        background: #38383a;
    }

    .focus-mode-active::-webkit-scrollbar-thumb {
        background: #0c9196;
        border-radius: 6px;
    }

    .focus-mode-active::-webkit-scrollbar-thumb:hover {
        background: #222222;
    }

    body.dark-mode .focus-mode-active::-webkit-scrollbar-thumb:hover {
        background: #eaeaea;
    }

    @media (max-width: 768px) {
        .focus-mode-active {
            padding: 60px 20px 20px 20px !important;
            font-size: 1.05em;
        }
        
        #btn-exit-focus {
            top: 10px;
            right: 10px;
            padding: 0.6rem 1rem;
            font-size: 0.9rem;
        }
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const btnEnter = document.getElementById('btn-enter-focus');
    const btnExit = document.getElementById('btn-exit-focus');
    const lecturaContainer = document.getElementById('lectura-container');
    
    console.log('üéØ Modo concentraci√≥n inicializado');
    console.log('Bot√≥n entrar:', btnEnter);
    console.log('Bot√≥n salir:', btnExit);
    console.log('Contenedor:', lecturaContainer);
    
    if (!btnEnter || !btnExit || !lecturaContainer) {
        console.error('‚ùå Faltan elementos necesarios');
        return;
    }

    // Funci√≥n para entrar
    function enterFocusMode() {
        console.log('üöÄ Entrando en modo concentraci√≥n...');
        
        // Agregar clases PRIMERO (esto siempre funciona)
        document.body.classList.add('focus-mode');
        lecturaContainer.classList.add('focus-mode-active');
        
        // Verificar que se aplic√≥
        console.log('‚úì Clase focus-mode en body:', document.body.classList.contains('focus-mode'));
        console.log('‚úì Clase focus-mode-active en container:', lecturaContainer.classList.contains('focus-mode-active'));
        
        // Verificar color de fondo
        const bgColor = window.getComputedStyle(lecturaContainer).backgroundColor;
        console.log('‚úì Color de fondo aplicado:', bgColor);
        
        // Intentar pantalla completa (opcional, no cr√≠tico)
        requestFullscreen();
        
        // Scroll al inicio
        setTimeout(() => {
            lecturaContainer.scrollTop = 0;
        }, 100);
        
        console.log('‚úÖ Modo concentraci√≥n activado');
    }

    // Funci√≥n para solicitar pantalla completa (opcional)
    function requestFullscreen() {
        // Verificar si el navegador soporta pantalla completa
        if (!document.fullscreenEnabled && 
            !document.webkitFullscreenEnabled && 
            !document.mozFullScreenEnabled) {
            console.log('‚ÑπÔ∏è Pantalla completa no disponible en este navegador');
            return;
        }

        // Intentar activar pantalla completa en el contenedor
        const requestFS = lecturaContainer.requestFullscreen || 
                         lecturaContainer.webkitRequestFullscreen || 
                         lecturaContainer.mozRequestFullScreen || 
                         lecturaContainer.msRequestFullscreen;

        if (requestFS) {
            requestFS.call(lecturaContainer)
                .then(() => {
                    console.log('‚úÖ Pantalla completa activada');
                })
                .catch(err => {
                    console.log('‚ÑπÔ∏è Pantalla completa no pudo activarse:', err.message);
                    console.log('‚ÑπÔ∏è El modo concentraci√≥n sigue funcionando sin pantalla completa');
                });
        }
    }

    // Funci√≥n para salir
    function exitFocusMode() {
        console.log('üëã Saliendo del modo concentraci√≥n...');
        
        document.body.classList.remove('focus-mode');
        lecturaContainer.classList.remove('focus-mode-active');
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        console.log('‚úÖ Modo normal restaurado');
    }

    // Event listeners
    btnEnter.addEventListener('click', function(e) {
        e.preventDefault();
        enterFocusMode();
    });

    btnExit.addEventListener('click', function(e) {
        e.preventDefault();
        exitFocusMode();
    });

    // Salir con ESC
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && document.body.classList.contains('focus-mode')) {
            exitFocusMode();
        }
    });

    console.log('‚úÖ Event listeners configurados');
});
</script>
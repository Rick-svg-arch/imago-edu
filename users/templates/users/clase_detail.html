{% extends 'layout.html' %}
{% block content %}
<div class="container-large">
    <div class="glass-card" style="padding: 2.5rem;">

        <!-- Encabezado de la clase -->
        <div style="text-align:center; margin-bottom: 2rem; border-bottom: 1px solid var(--border-color); padding-bottom: 2rem;">
            <h1><i class="fas fa-chalkboard"></i> {{ clase.nombre }}</h1>
            <p style="opacity: 0.8;">Organización: {{ clase.organizacion.nombre }}</p>
        </div>

        <div class="dashboard-grid">
            <!-- Widget del Profesor -->
            <div class="dashboard-widget">
                <h2><i class="fas fa-user-tie"></i> Profesor a Cargo</h2>
                <div style="display:flex; align-items:center; gap:1.5rem;">
                    <img src="{{ clase.profesor.profile.avatar.url }}" alt="Avatar" width="80" style="border-radius:50%;">
                    <div>
                        <h4>{{ clase.profesor.get_full_name }}</h4>
                        <p style="opacity:0.7;">{{ clase.profesor.email }}</p>
                    </div>
                </div>
            </div>

            <!-- Widget de Acciones -->
            <div class="dashboard-widget">
                <h2><i class="fas fa-cogs"></i> Acciones</h2>
                <div class="respuesta-acciones" style="border: none; padding: 0; margin: 0;">
                    <a href="{% url 'users:dashboard' %}"><i class="fas fa-arrow-left"></i> Volver al Panel</a>
                    <a href="{% url 'users:class_edit' pk=clase.pk %}"><i class="fas fa-edit"></i> Editar Clase</a>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- SECCIÓN DE ESTUDIANTES - TABLA -->
        <!-- ============================================= -->
        <div class="dashboard-widget" style="margin-top: 2rem;">
            <h2><i class="fas fa-users"></i> Estudiantes Inscritos ({{ clase.estudiantes.count }})</h2>
            
            <div style="overflow-x: auto;"> <!-- Para responsividad en móviles -->
                <table class="table student-list-table">
                    <thead>
                        <tr>
                            <th scope="col" style="width: 80px;">Avatar</th>
                            <th scope="col">Nombre Completo</th>
                            <th scope="col">Nombre de Usuario</th>
                            <th scope="col">Email</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for estudiante in clase.estudiantes.all %}
                        <tr>
                            <td class="avatar-cell">
                                <img src="{{ estudiante.profile.avatar.url }}" alt="Avatar de {{ estudiante.username }}">
                            </td>
                            <td><strong>{{ estudiante.get_full_name }}</strong></td>
                            <td>{{ estudiante.username }}</td>
                            <td>{{ estudiante.email }}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="4" style="text-align: center; padding: 2rem; opacity: 0.7;">
                                No hay estudiantes inscritos en esta clase.
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}